<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SV Gutachten SchweiÃŸtechnik v10.0 TÃœV-Edition</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/docx/8.2.0/docx.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  <style>
    *{box-sizing:border-box;margin:0;padding:0}body{font-family:system-ui,-apple-system,sans-serif;background:#f8fafc;min-height:100vh}
    @keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}}@keyframes spin{to{transform:rotate(360deg)}}
    .loading{display:inline-block;width:20px;height:20px;border:2px solid #fff;border-top-color:transparent;border-radius:50%;animation:spin .8s linear infinite}
    .grid-2{display:grid;grid-template-columns:1fr 1fr;gap:24px}.grid-3{display:grid;grid-template-columns:repeat(3,1fr);gap:16px}
    .grid-4{display:grid;grid-template-columns:repeat(4,1fr);gap:16px}.grid-5{display:grid;grid-template-columns:repeat(5,1fr);gap:12px}
    @media(max-width:1024px){.grid-2{grid-template-columns:1fr}.grid-4{grid-template-columns:repeat(2,1fr)}}
    @media(max-width:768px){.grid-3,.grid-4{grid-template-columns:1fr}.grid-5{grid-template-columns:repeat(2,1fr)}}
  </style>
</head>
<body>
<div id="root"></div>
<script type="text/babel">
const{useState,useEffect,useRef}=React;
const GRENZWERTE={haerte:{"1.1":{max:380},"1.2":{max:380},"2":{max:450},"3":{max:450},"8.1":{max:null},"10":{max:350}},zugfestigkeit:{"S235":{min:360},"S275":{min:410},"S355":{min:470},"S355J2+N":{min:470},"S460":{min:540},"S690":{min:770},"1.4301":{min:520},"1.4571":{min:520},"1.4462":{min:640}},biegeversuch:{standardWinkel:180,maxRisslaenge:3}};
const WERKSTOFFGRUPPEN={"S235":"1.1","S275":"1.1","S355":"1.2","S355J2+N":"1.2","S460":"2","S690":"3","1.4301":"8.1","1.4571":"8.1","1.4462":"10"};
const FEHLERKATALOG={"100":{name:"Riss",kritisch:true},"104":{name:"Kraterriss",kritisch:true},"2011":{name:"Pore",kritisch:false},"401":{name:"Bindefehler",kritisch:true},"402":{name:"Einbrandfehler",kritisch:true},"502":{name:"NahtÃ¼berhÃ¶hung",kritisch:false},"507":{name:"SchweiÃŸspritzer",kritisch:false}};
const getWerkstoffgruppe=w=>WERKSTOFFGRUPPEN[w]||WERKSTOFFGRUPPEN[w?.split(" ")[0]]||"1.2";
const bewerteHaerte=(w,m)=>{if(!m)return{status:"nicht geprÃ¼ft",text:"Keine Messwerte"};const g=getWerkstoffgruppe(w),grenz=GRENZWERTE.haerte[g];if(!grenz||grenz.max===null)return{status:"bestanden",text:m+" HV10"};const v=parseFloat(m);return v<=grenz.max?{status:"bestanden",text:v+" â‰¤ "+grenz.max+" HV10"}:{status:"nicht bestanden",text:v+" > "+grenz.max+" HV10"}};
const bewerteZugversuch=(w,m)=>{if(!m)return{status:"nicht geprÃ¼ft",text:"Keine Messwerte"};const grenz=GRENZWERTE.zugfestigkeit[w?.split(" ")[0]];if(!grenz)return{status:"bestanden",text:m+" N/mmÂ²"};const v=parseFloat(m);return v>=grenz.min?{status:"bestanden",text:v+" â‰¥ "+grenz.min+" N/mmÂ²"}:{status:"nicht bestanden",text:v+" < "+grenz.min+" N/mmÂ²"}};
const bewerteBiegeversuch=(wi,r)=>{if(!wi&&!r)return{status:"nicht geprÃ¼ft",text:"Keine Messwerte"};const w=parseFloat(wi)||180,riss=parseFloat(r)||0;return(w>=180&&riss<=3)?{status:"bestanden",text:w+"Â°, Riss "+riss+"mm"}:{status:"nicht bestanden",text:w<180?w+"Â° < 180Â°":"Riss "+riss+"mm > 3mm"}};
const getStatusColor=s=>{switch(s?.toLowerCase()){case'bestanden':return{bg:"#dcfce7",color:"#166534",border:"#22c55e"};case'nacharbeit':return{bg:"#fef3c7",color:"#92400e",border:"#f59e0b"};case'nicht bestanden':return{bg:"#fee2e2",color:"#991b1b",border:"#ef4444"};default:return{bg:"#f1f5f9",color:"#475569",border:"#94a3b8"}}};
const generateGutachtenDOCX=async(data)=>{if(typeof docx==='undefined')return;const{Document,Paragraph,TextRun,HeadingLevel,AlignmentType,Table,TableRow,TableCell,WidthType,BorderStyle}=docx;const heute=new Date().toLocaleDateString('de-AT');const gruppe=getWerkstoffgruppe(data.werkstoff);const tableBorder={style:BorderStyle.SINGLE,size:1,color:"CCCCCC"};const cellBorders={top:tableBorder,bottom:tableBorder,left:tableBorder,right:tableBorder};const createCell=(text,bold=false,shading=null)=>new TableCell({children:[new Paragraph({children:[new TextRun({text:text||"-",bold,size:22})]})],width:{size:50,type:WidthType.PERCENTAGE},borders:cellBorders,shading:shading?{fill:shading}:undefined});const statusText=data.status==="Bestanden"?"BESTANDEN":data.status==="Nicht bestanden"?"NICHT BESTANDEN":"NACHARBEIT";const doc=new Document({sections:[{children:[new Paragraph({children:[new TextRun({text:"PRÃœFGUTACHTEN",bold:true,size:36})],heading:HeadingLevel.HEADING_1,alignment:AlignmentType.CENTER}),new Paragraph({children:[new TextRun({text:"SchweiÃŸtechnische PrÃ¼fung nach EN ISO 15614-1",size:24})],alignment:AlignmentType.CENTER}),new Table({width:{size:100,type:WidthType.PERCENTAGE},rows:[new TableRow({children:[createCell("Auftragsnummer:",true,"E8E8E8"),createCell(data.auftragsnummer||"")]}),new TableRow({children:[createCell("PrÃ¼fgegenstand:",true,"E8E8E8"),createCell(data.pruefgegenstand||"")]}),new TableRow({children:[createCell("Werkstoff:",true,"E8E8E8"),createCell((data.werkstoff||"")+" (Gruppe "+gruppe+")")]}),new TableRow({children:[createCell("Bewertungsgruppe:",true,"E8E8E8"),createCell("ISO 5817 "+(data.bewertungsgruppe||"C"))]})]}),new Paragraph({children:[new TextRun({text:"ANAMNESE",bold:true})]}),new Paragraph({children:[new TextRun({text:data.anamnese||"Keine Anamnese",size:20})]}),new Paragraph({children:[new TextRun({text:"DIAGNOSE",bold:true})]}),new Paragraph({children:[new TextRun({text:data.diagnose||"Keine Diagnose",size:20})]}),new Paragraph({children:[new TextRun({text:"CONCLUSIO",bold:true})]}),new Paragraph({children:[new TextRun({text:data.conclusio||"Keine Conclusio",size:20})]}),new Paragraph({children:[new TextRun({text:"GESAMTERGEBNIS: ",bold:true,size:28}),new TextRun({text:statusText,bold:true,size:28,color:data.status==="Bestanden"?"008000":"CC0000"})],alignment:AlignmentType.CENTER}),new Paragraph({children:[new TextRun({text:"________________________________________"})],alignment:AlignmentType.RIGHT}),new Paragraph({children:[new TextRun({text:"Gerichtlich beeideter SachverstÃ¤ndiger",size:20,italics:true})],alignment:AlignmentType.RIGHT}),new Paragraph({children:[new TextRun({text:"Wien, "+heute,size:20})],alignment:AlignmentType.RIGHT})]}]});const blob=await docx.Packer.toBlob(doc);saveAs(blob,"Gutachten_"+(data.auftragsnummer||'NEU')+"_"+heute.replace(/\./g,'-')+".docx")};
function SchweissGutachterApp(){
  const[activeTab,setActiveTab]=useState('analyse');
  const[apiStatus,setApiStatus]=useState({anthropic:false});
  const[selectedImages,setSelectedImages]=useState([]);
  const[imagePreviews,setImagePreviews]=useState([]);
  const[analyzing,setAnalyzing]=useState(false);
  const[analysisResult,setAnalysisResult]=useState(null);
  const fileInputRef=useRef(null);
  const[protokoll,setProtokoll]=useState({auftragsnummer:"",pruefgegenstand:"",auftraggeber:"",werkstoff:"S355",bewertungsgruppe:"C",wanddicke:"",vtErgebnis:"nicht geprÃ¼ft",pt:"nicht geprÃ¼ft",mt:"nicht geprÃ¼ft",ut:"nicht geprÃ¼ft",rt:"nicht geprÃ¼ft",haerteMax:"",zugfestigkeit:"",biegewinkel:"",risslaenge:"",anamnese:"",diagnose:"",conclusio:"",status:""});
  const[auftraege]=useState([{id:"1",auftragsnummer:"PA-2024-0042",pruefgegenstand:"DruckbehÃ¤lter DB-2024-15",auftraggeber:"MÃ¼ller Anlagenbau",werkstoff:"S355J2+N",bewertungsgruppe:"B",status:"Bestanden",haerteMax:"285",zugfestigkeit:"520"},{id:"2",auftragsnummer:"PA-2024-0043",pruefgegenstand:"Rohrleitung DN150",auftraggeber:"Kraftwerk SÃ¼d AG",werkstoff:"1.4571",bewertungsgruppe:"B",status:"Bestanden",zugfestigkeit:"545"},{id:"3",auftragsnummer:"WPS-2024-008",pruefgegenstand:"WPS-Qualifizierung MAG",auftraggeber:"Stahlbau Huber",werkstoff:"S460",bewertungsgruppe:"B",status:"Nacharbeit",haerteMax:"465",zugfestigkeit:"580"}]);
  const[geb,setGeb]=useState({aktenstudium:1.5,ortsaugenschein:2,recherche:2,berechnung:1.5,gutachten:5,korrektur:1,satz:180,fahrzeit:1,km:40,pruefmittel:45,kopien:15,druck:25,labor:0});
  useEffect(()=>{fetch('/api/health').then(r=>r.json()).then(d=>setApiStatus({anthropic:d.anthropic})).catch(()=>setApiStatus({anthropic:false}))},[]);
  const werkstoffe=["S235","S275","S355","S355J2+N","S460","S690","1.4301","1.4571","1.4462"];
  const handleImageSelect=(e)=>{const files=Array.from(e.target.files);if(files.length>0){const newFiles=[...selectedImages,...files].slice(0,4);setSelectedImages(newFiles);setImagePreviews(newFiles.map(f=>URL.createObjectURL(f)));setAnalysisResult(null)}};
  const removeImage=(i)=>{setSelectedImages(p=>p.filter((_,idx)=>idx!==i));setImagePreviews(p=>p.filter((_,idx)=>idx!==i))};
  const resetAnalysis=()=>{setSelectedImages([]);setImagePreviews([]);setAnalysisResult(null);if(fileInputRef.current)fileInputRef.current.value=''};
  const analyzeImages=async()=>{if(selectedImages.length===0)return;setAnalyzing(true);try{const formData=new FormData();selectedImages.forEach(img=>formData.append('images',img));formData.append('werkstoff',protokoll.werkstoff);formData.append('bewertungsgruppe',protokoll.bewertungsgruppe);formData.append('wanddicke',protokoll.wanddicke);const response=await fetch('/api/analyze',{method:'POST',body:formData});const data=await response.json();if(data.success){setAnalysisResult(data.analysis);setProtokoll(p=>({...p,vtErgebnis:data.analysis.vtErgebnis,anamnese:data.analysis.anamnese,diagnose:data.analysis.diagnose,conclusio:data.analysis.conclusio,status:data.analysis.status}))}else{alert('Analyse fehlgeschlagen: '+data.error)}}catch(error){alert('Fehler: '+error.message)}setAnalyzing(false)};
  const muehe=(geb.aktenstudium+geb.ortsaugenschein+geb.recherche+geb.berechnung+geb.gutachten+geb.korrektur)*geb.satz;
  const zeit=geb.fahrzeit*22.7,reise=geb.km*0.42,bar=geb.pruefmittel+geb.kopien+geb.druck+geb.labor;
  const netto=muehe+zeit+reise+bar,gesamt=netto*1.2;
  return(<div style={{minHeight:"100vh",background:"#f8fafc"}}>
    <header style={{background:"linear-gradient(135deg,#1f2937,#374151)",padding:"16px 24px",borderBottom:"4px solid #f97316"}}>
      <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",maxWidth:"1400px",margin:"0 auto"}}>
        <div style={{display:"flex",alignItems:"center",gap:"16px"}}>
          <div style={{background:"linear-gradient(135deg,#f97316,#ea580c)",padding:"12px",borderRadius:"12px"}}><span style={{fontSize:"28px"}}>ğŸ”¥</span></div>
          <div><h1 style={{color:"#fff",fontSize:"20px",margin:0}}>SV Gutachten SchweiÃŸtechnik</h1><p style={{color:"#f97316",fontSize:"11px",margin:"4px 0 0"}}>v10.0 TÃœV-Edition Â· Claude Vision Â· ISO 15614-1</p></div>
        </div>
        <div style={{display:"flex",gap:"12px"}}>
          <span style={{background:apiStatus.anthropic?"rgba(34,197,94,0.2)":"rgba(239,68,68,0.2)",border:"1px solid "+(apiStatus.anthropic?"#22c55e":"#ef4444"),color:apiStatus.anthropic?"#4ade80":"#f87171",padding:"6px 12px",borderRadius:"8px",fontSize:"11px"}}>Claude Vision: {apiStatus.anthropic?"âœ“":"âœ—"}</span>
          <span style={{background:"rgba(249,115,22,0.15)",border:"1px solid rgba(249,115,22,0.3)",color:"#fff",padding:"6px 12px",borderRadius:"8px",fontSize:"11px"}}>TÃœV-konform</span>
        </div>
      </div>
    </header>
    <nav style={{background:"#fff",borderBottom:"1px solid #e2e8f0"}}>
      <div style={{display:"flex",maxWidth:"1400px",margin:"0 auto"}}>
        {[{id:'analyse',label:'ğŸ” KI-Analyse'},{id:'protokoll',label:'ğŸ“‹ PrÃ¼fprotokoll'},{id:'auftraege',label:'ğŸ“Š AuftrÃ¤ge'},{id:'gebuehren',label:'ğŸ’° GebÃ¼hren'},{id:'katalog',label:'ğŸ“– Fehlerkatalog'}].map(tab=>(<button key={tab.id} onClick={()=>setActiveTab(tab.id)} style={{padding:"16px 24px",background:activeTab===tab.id?"#1f2937":"transparent",color:activeTab===tab.id?"#fff":"#64748b",border:"none",borderBottom:activeTab===tab.id?"3px solid #f97316":"3px solid transparent",fontSize:"14px",fontWeight:600,cursor:"pointer"}}>{tab.label}</button>))}
      </div>
    </nav>
    <main style={{padding:"24px",maxWidth:"1400px",margin:"0 auto"}}>
      {activeTab==='analyse'&&(<div className="grid-2">
        <div>
          <div style={{background:"#fff",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",marginBottom:"20px"}}>
            <div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"16px"}}>
              <h3 style={{margin:0,fontSize:"16px"}}>ğŸ“· SchweiÃŸnaht-Fotos (bis zu 4)</h3>
              {(selectedImages.length>0||analysisResult)&&(<button onClick={resetAnalysis} style={{padding:"8px 16px",background:"#ef4444",color:"#fff",border:"none",borderRadius:"6px",fontSize:"13px"}}>ğŸ”„ Neu</button>)}
            </div>
            <input type="file" ref={fileInputRef} accept="image/*" multiple onChange={handleImageSelect} style={{display:"none"}}/>
            {imagePreviews.length>0&&(<div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"16px"}}>{imagePreviews.map((p,i)=>(<div key={i} style={{position:"relative"}}><img src={p} alt={"Foto "+(i+1)} style={{width:"100%",height:"140px",objectFit:"cover",borderRadius:"8px",border:"2px solid #e2e8f0"}}/><button onClick={()=>removeImage(i)} style={{position:"absolute",top:"8px",right:"8px",background:"#ef4444",color:"#fff",border:"none",borderRadius:"50%",width:"28px",height:"28px"}}>âœ•</button><span style={{position:"absolute",bottom:"8px",left:"8px",background:"rgba(0,0,0,0.7)",color:"#fff",padding:"4px 8px",borderRadius:"4px",fontSize:"10px"}}>{["Draufsicht","Wurzelseite","Seitenansicht","Detail"][i]}</span></div>))}</div>)}
            {selectedImages.length<4&&(<div onClick={()=>fileInputRef.current?.click()} style={{border:"2px dashed #cbd5e1",borderRadius:"12px",padding:selectedImages.length>0?"20px":"40px",textAlign:"center",cursor:"pointer",background:"#f8fafc"}}><span style={{fontSize:selectedImages.length>0?"32px":"48px"}}>ğŸ“·</span><p style={{color:"#64748b",marginTop:"8px",marginBottom:0}}>{selectedImages.length===0?"Fotos hochladen":"+ Weitere ("+(4-selectedImages.length)+" Ã¼brig)"}</p></div>)}
            <button onClick={analyzeImages} disabled={selectedImages.length===0||analyzing} style={{width:"100%",marginTop:"16px",padding:"16px",background:analyzing?"#94a3b8":"linear-gradient(135deg,#f97316,#ea580c)",color:"#fff",border:"none",borderRadius:"8px",fontSize:"15px",fontWeight:600,cursor:selectedImages.length>0?"pointer":"not-allowed"}}>{analyzing?(<><span className="loading"></span> Analysiere...</>):("ğŸ¤– "+selectedImages.length+" Foto(s) analysieren")}</button>
          </div>
          <div style={{background:"#fff",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)"}}>
            <h3 style={{margin:"0 0 16px",fontSize:"16px"}}>âš™ï¸ Werkstoffdaten</h3>
            <div style={{marginBottom:"16px"}}><label style={{fontSize:"12px",color:"#64748b",display:"block",marginBottom:"4px"}}>Werkstoff</label><select value={protokoll.werkstoff} onChange={(e)=>setProtokoll({...protokoll,werkstoff:e.target.value})} style={{width:"100%",padding:"10px",border:"1px solid #e2e8f0",borderRadius:"6px"}}>{werkstoffe.map(w=>(<option key={w} value={w}>{w} (Gruppe {getWerkstoffgruppe(w)})</option>))}</select></div>
            {protokoll.werkstoff&&(<div style={{background:"#eff6ff",border:"1px solid #bfdbfe",borderRadius:"8px",padding:"12px",marginBottom:"16px"}}><p style={{fontSize:"12px",color:"#1e40af",margin:"0 0 8px",fontWeight:600}}>ğŸ“‹ Grenzwerte (Gruppe {getWerkstoffgruppe(protokoll.werkstoff)}):</p><div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px",fontSize:"11px"}}><div><strong>HÃ¤rte max:</strong> {GRENZWERTE.haerte[getWerkstoffgruppe(protokoll.werkstoff)]?.max||"kein"} HV10</div><div><strong>Zugfestigkeit min:</strong> {GRENZWERTE.zugfestigkeit[protokoll.werkstoff.split(" ")[0]]?.min||"n.a."} N/mmÂ²</div></div></div>)}
            <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"}}><div><label style={{fontSize:"12px",color:"#64748b",display:"block",marginBottom:"4px"}}>Wanddicke (mm)</label><input type="number" value={protokoll.wanddicke} onChange={(e)=>setProtokoll({...protokoll,wanddicke:e.target.value})} placeholder="z.B. 12" style={{width:"100%",padding:"10px",border:"1px solid #e2e8f0",borderRadius:"6px"}}/></div><div><label style={{fontSize:"12px",color:"#64748b",display:"block",marginBottom:"4px"}}>Bewertungsgruppe</label><div style={{display:"flex",gap:"8px"}}>{["B","C","D"].map(g=>(<button key={g} onClick={()=>setProtokoll({...protokoll,bewertungsgruppe:g})} style={{flex:1,padding:"10px",borderRadius:"6px",fontWeight:600,background:protokoll.bewertungsgruppe===g?"#f97316":"#f1f5f9",color:protokoll.bewertungsgruppe===g?"#fff":"#64748b",border:"none"}}>{g}</button>))}</div></div></div>
          </div>
        </div>
        <div style={{background:"#fff",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)"}}>
          <h3 style={{margin:"0 0 16px",fontSize:"16px"}}>ğŸ“‹ KI-Analyse-Ergebnis</h3>
          {analysisResult?(<>
            <div style={{background:getStatusColor(analysisResult.status).bg,border:"2px solid "+getStatusColor(analysisResult.status).border,borderRadius:"12px",padding:"16px",marginBottom:"20px",textAlign:"center"}}><span style={{fontSize:"20px",fontWeight:700,color:getStatusColor(analysisResult.status).color}}>{analysisResult.status==='Bestanden'?'âœ“ BESTANDEN':analysisResult.status==='Nacharbeit'?'âš  NACHARBEIT':'âœ— NICHT BESTANDEN'}</span></div>
            {[{title:'ANAMNESE',content:analysisResult.anamnese,color:'#3b82f6',icon:'ğŸ”'},{title:'DIAGNOSE',content:analysisResult.diagnose,color:'#f97316',icon:'âš–ï¸'},{title:'CONCLUSIO',content:analysisResult.conclusio,color:getStatusColor(analysisResult.status).border,icon:'ğŸ“‹'}].map((s,i)=>(<div key={i} style={{marginBottom:"16px"}}><h4 style={{fontSize:"12px",color:s.color,margin:"0 0 8px"}}>{s.icon} {s.title}</h4><pre style={{fontSize:"11px",whiteSpace:"pre-wrap",background:"#f8fafc",padding:"12px",borderRadius:"6px",borderLeft:"3px solid "+s.color,maxHeight:"150px",overflow:"auto",margin:0}}>{s.content||'Keine Daten'}</pre></div>))}
            {analysisResult.erkannteFehlercodes?.length>0&&(<div style={{marginBottom:"16px"}}><h4 style={{fontSize:"12px",color:"#dc2626",margin:"0 0 8px"}}>âš ï¸ Fehler (ISO 6520-1):</h4><div style={{display:"flex",flexWrap:"wrap",gap:"8px"}}>{analysisResult.erkannteFehlercodes.map((f,i)=>(<span key={i} style={{background:f.kritisch?"#fef2f2":"#f8fafc",border:"1px solid "+(f.kritisch?"#fecaca":"#e2e8f0"),padding:"4px 8px",borderRadius:"4px",fontSize:"11px"}}><strong>{f.code}</strong> {f.name}</span>))}</div></div>)}
            <button onClick={()=>generateGutachtenDOCX({...protokoll,...analysisResult,status:analysisResult.status})} style={{width:"100%",padding:"14px",background:"linear-gradient(135deg,#4f46e5,#6366f1)",color:"#fff",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:600}}>ğŸ“„ DOCX exportieren</button>
          </>):(<div style={{textAlign:"center",padding:"60px",color:"#94a3b8"}}><span style={{fontSize:"64px",opacity:0.5}}>ğŸ¤–</span><p style={{marginTop:"16px"}}>Lade SchweiÃŸnaht-Fotos hoch</p><p style={{fontSize:"12px"}}>Claude Vision analysiert nach ISO 5817</p></div>)}
        </div>
      </div>)}
      {activeTab==='protokoll'&&(<div className="grid-2">
        <div><div style={{background:"#fff",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",marginBottom:"20px"}}><h3 style={{margin:"0 0 16px",fontSize:"16px"}}>ğŸ“‹ Auftragsdaten</h3><div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"}}>{[["Auftragsnummer","auftragsnummer","PA-2024-XXXX"],["PrÃ¼fgegenstand","pruefgegenstand","z.B. DruckbehÃ¤lter"],["Auftraggeber","auftraggeber","Firma"],["Wanddicke (mm)","wanddicke","12"]].map(([label,field,ph])=>(<div key={field}><label style={{fontSize:"12px",color:"#64748b",display:"block",marginBottom:"4px"}}>{label}</label><input type="text" value={protokoll[field]||""} onChange={(e)=>setProtokoll({...protokoll,[field]:e.target.value})} placeholder={ph} style={{width:"100%",padding:"10px",border:"1px solid #e2e8f0",borderRadius:"6px"}}/></div>))}</div></div></div>
        <div><div style={{background:"#fff",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)"}}><h3 style={{margin:"0 0 16px",fontSize:"16px"}}>âš™ï¸ Mechanische PrÃ¼fungen</h3>
          <div style={{marginBottom:"16px",padding:"12px",background:"#f8fafc",borderRadius:"8px"}}><div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"}}><span style={{fontSize:"13px",fontWeight:600}}>HÃ¤rteprÃ¼fung (ISO 9015-1)</span>{protokoll.haerteMax&&(<span style={{fontSize:"11px",padding:"4px 8px",borderRadius:"4px",background:bewerteHaerte(protokoll.werkstoff,protokoll.haerteMax).status==="bestanden"?"#dcfce7":"#fee2e2",color:bewerteHaerte(protokoll.werkstoff,protokoll.haerteMax).status==="bestanden"?"#166534":"#991b1b"}}>{bewerteHaerte(protokoll.werkstoff,protokoll.haerteMax).text}</span>)}</div><div style={{display:"flex",gap:"8px",alignItems:"center"}}><input type="number" placeholder="Max. HÃ¤rtewert" value={protokoll.haerteMax} onChange={(e)=>setProtokoll({...protokoll,haerteMax:e.target.value})} style={{flex:1,padding:"8px",border:"1px solid #e2e8f0",borderRadius:"4px"}}/><span style={{fontSize:"12px",color:"#64748b"}}>HV10</span></div></div>
          <div style={{marginBottom:"16px",padding:"12px",background:"#f8fafc",borderRadius:"8px"}}><div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"}}><span style={{fontSize:"13px",fontWeight:600}}>Zugversuch (ISO 4136)</span>{protokoll.zugfestigkeit&&(<span style={{fontSize:"11px",padding:"4px 8px",borderRadius:"4px",background:bewerteZugversuch(protokoll.werkstoff,protokoll.zugfestigkeit).status==="bestanden"?"#dcfce7":"#fee2e2",color:bewerteZugversuch(protokoll.werkstoff,protokoll.zugfestigkeit).status==="bestanden"?"#166534":"#991b1b"}}>{bewerteZugversuch(protokoll.werkstoff,protokoll.zugfestigkeit).text}</span>)}</div><div style={{display:"flex",gap:"8px",alignItems:"center"}}><input type="number" placeholder="Rm" value={protokoll.zugfestigkeit} onChange={(e)=>setProtokoll({...protokoll,zugfestigkeit:e.target.value})} style={{flex:1,padding:"8px",border:"1px solid #e2e8f0",borderRadius:"4px"}}/><span style={{fontSize:"12px",color:"#64748b"}}>N/mmÂ²</span></div></div>
          <div style={{padding:"12px",background:"#f8fafc",borderRadius:"8px"}}><div style={{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"8px"}}><span style={{fontSize:"13px",fontWeight:600}}>Biegeversuch (ISO 5173)</span>{(protokoll.biegewinkel||protokoll.risslaenge)&&(<span style={{fontSize:"11px",padding:"4px 8px",borderRadius:"4px",background:bewerteBiegeversuch(protokoll.biegewinkel,protokoll.risslaenge).status==="bestanden"?"#dcfce7":"#fee2e2",color:bewerteBiegeversuch(protokoll.biegewinkel,protokoll.risslaenge).status==="bestanden"?"#166534":"#991b1b"}}>{bewerteBiegeversuch(protokoll.biegewinkel,protokoll.risslaenge).text}</span>)}</div><div style={{display:"flex",gap:"8px",alignItems:"center"}}><input type="number" placeholder="Winkel" value={protokoll.biegewinkel} onChange={(e)=>setProtokoll({...protokoll,biegewinkel:e.target.value})} style={{width:"80px",padding:"8px",border:"1px solid #e2e8f0",borderRadius:"4px"}}/><span style={{fontSize:"12px",color:"#64748b"}}>Â°</span><input type="number" placeholder="Riss" value={protokoll.risslaenge} onChange={(e)=>setProtokoll({...protokoll,risslaenge:e.target.value})} style={{width:"80px",padding:"8px",border:"1px solid #e2e8f0",borderRadius:"4px"}}/><span style={{fontSize:"12px",color:"#64748b"}}>mm</span></div></div>
        </div></div>
      </div>)}
      {activeTab==='auftraege'&&(<div><div className="grid-4" style={{marginBottom:"24px"}}>{[{label:"Gesamt",value:auftraege.length,color:"#3b82f6",icon:"ğŸ“‹"},{label:"Bestanden",value:auftraege.filter(a=>a.status==="Bestanden").length,color:"#22c55e",icon:"âœ“"},{label:"Nacharbeit",value:auftraege.filter(a=>a.status==="Nacharbeit").length,color:"#f59e0b",icon:"âš "},{label:"Nicht best.",value:auftraege.filter(a=>a.status==="Nicht bestanden").length,color:"#ef4444",icon:"âœ—"}].map((s,i)=>(<div key={i} style={{background:"#fff",borderRadius:"12px",padding:"20px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",borderLeft:"4px solid "+s.color}}><p style={{fontSize:"12px",color:"#64748b",margin:0}}>{s.label}</p><p style={{fontSize:"28px",fontWeight:700,margin:"8px 0 0",color:s.color}}>{s.icon} {s.value}</p></div>))}</div><div style={{background:"#fff",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)"}}><h3 style={{margin:"0 0 20px",fontSize:"16px"}}>ğŸ“Š PrÃ¼fauftrÃ¤ge</h3>{auftraege.map(a=>{const c=getStatusColor(a.status);return(<div key={a.id} style={{border:"1px solid "+c.border,borderRadius:"12px",padding:"20px",marginBottom:"16px",background:c.bg}}><div style={{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:"12px"}}><div><span style={{background:c.border,color:"#fff",padding:"4px 10px",borderRadius:"6px",fontSize:"11px",fontWeight:600}}>{a.auftragsnummer}</span><h4 style={{margin:"8px 0 4px",fontSize:"16px"}}>{a.pruefgegenstand}</h4><p style={{fontSize:"13px",color:"#64748b",margin:0}}>{a.auftraggeber}</p></div><span style={{fontSize:"24px",fontWeight:700,color:c.color}}>{a.status==="Bestanden"?"âœ“":a.status==="Nicht bestanden"?"âœ—":"âš "}</span></div><div style={{display:"flex",gap:"16px",flexWrap:"wrap",fontSize:"12px"}}><span>ğŸ”§ {a.werkstoff}</span><span>ğŸ“Š ISO 5817 {a.bewertungsgruppe}</span>{a.haerteMax&&<span>ğŸ”¨ {a.haerteMax} HV10</span>}{a.zugfestigkeit&&<span>ğŸ“ {a.zugfestigkeit} N/mmÂ²</span>}</div></div>)})}</div></div>)}
      {activeTab==='gebuehren'&&(<div className="grid-2"><div><div style={{background:"#fff",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)",marginBottom:"20px"}}><h3 style={{margin:"0 0 16px",fontSize:"16px"}}>â±ï¸ Zeitaufwand</h3><div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"}}>{[["Aktenstudium","aktenstudium"],["Ortsaugenschein","ortsaugenschein"],["Recherche","recherche"],["Berechnung","berechnung"],["Gutachten","gutachten"],["Korrektur","korrektur"]].map(([l,f])=>(<div key={f} style={{display:"flex",alignItems:"center",gap:"8px"}}><span style={{fontSize:"12px",flex:1}}>{l}</span><input type="number" step="0.5" value={geb[f]} onChange={(e)=>setGeb({...geb,[f]:parseFloat(e.target.value)||0})} style={{width:"70px",padding:"8px",border:"1px solid #e2e8f0",borderRadius:"4px",textAlign:"right"}}/><span style={{fontSize:"11px",color:"#64748b",width:"20px"}}>h</span></div>))}</div><div style={{marginTop:"16px",padding:"12px",background:"#f8fafc",borderRadius:"8px"}}><div style={{display:"flex",justifyContent:"space-between",alignItems:"center"}}><span style={{fontWeight:600}}>Stundensatz</span><div style={{display:"flex",alignItems:"center",gap:"8px"}}><input type="number" value={geb.satz} onChange={(e)=>setGeb({...geb,satz:parseFloat(e.target.value)||0})} style={{width:"80px",padding:"8px",border:"1px solid #e2e8f0",borderRadius:"4px",textAlign:"right"}}/><span>â‚¬/h</span></div></div></div></div><div style={{background:"#fff",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)"}}><h3 style={{margin:"0 0 16px",fontSize:"16px"}}>ğŸš— Reisekosten</h3><div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"}}>{[["Fahrzeit","fahrzeit","h","Ã—22,70â‚¬"],["Kilometer","km","km","Ã—0,42â‚¬"],["PrÃ¼fmittel","pruefmittel","â‚¬",""],["Kopien","kopien","â‚¬",""],["Druck","druck","â‚¬",""],["Labor","labor","â‚¬",""]].map(([l,f,u,m])=>(<div key={f} style={{display:"flex",alignItems:"center",gap:"8px"}}><span style={{fontSize:"12px",flex:1}}>{l}</span><input type="number" step={u==="h"?"0.5":"1"} value={geb[f]} onChange={(e)=>setGeb({...geb,[f]:parseFloat(e.target.value)||0})} style={{width:"70px",padding:"8px",border:"1px solid #e2e8f0",borderRadius:"4px",textAlign:"right"}}/><span style={{fontSize:"11px",color:"#64748b",width:"50px"}}>{u} {m}</span></div>))}</div></div></div><div style={{background:"linear-gradient(135deg,#1f2937,#374151)",borderRadius:"12px",padding:"24px",color:"#fff"}}><h3 style={{margin:"0 0 24px",fontSize:"18px",color:"#f97316"}}>ğŸ’° Honorar nach GebAG</h3><div style={{marginBottom:"24px"}}>{[["MÃ¼hewaltung",(geb.aktenstudium+geb.ortsaugenschein+geb.recherche+geb.berechnung+geb.gutachten+geb.korrektur).toFixed(1)+"h Ã— "+geb.satz+"â‚¬",muehe],["ZeitversÃ¤umnis",geb.fahrzeit+"h Ã— 22,70â‚¬",zeit],["Reisekosten",geb.km+"km Ã— 0,42â‚¬",reise],["Barauslagen","PrÃ¼fmittel etc.",bar]].map(([l,d,v])=>(<div key={l} style={{display:"flex",justifyContent:"space-between",padding:"12px 0",borderBottom:"1px solid rgba(255,255,255,0.1)"}}><div><p style={{margin:0,fontWeight:600}}>{l}</p><p style={{margin:"4px 0 0",fontSize:"11px",color:"rgba(255,255,255,0.6)"}}>{d}</p></div><span style={{fontWeight:600,fontSize:"16px"}}>â‚¬ {v.toFixed(2)}</span></div>))}</div><div style={{padding:"16px",background:"rgba(249,115,22,0.2)",borderRadius:"8px",marginBottom:"16px"}}><div style={{display:"flex",justifyContent:"space-between",marginBottom:"8px"}}><span>Netto</span><span style={{fontWeight:600}}>â‚¬ {netto.toFixed(2)}</span></div><div style={{display:"flex",justifyContent:"space-between",fontSize:"12px",color:"rgba(255,255,255,0.7)"}}><span>+ 20% USt</span><span>â‚¬ {(netto*0.2).toFixed(2)}</span></div></div><div style={{padding:"20px",background:"linear-gradient(135deg,#f97316,#ea580c)",borderRadius:"12px",textAlign:"center"}}><p style={{margin:"0 0 8px",fontSize:"14px",opacity:0.9}}>Gesamt inkl. USt</p><p style={{margin:0,fontSize:"36px",fontWeight:700}}>â‚¬ {gesamt.toFixed(2)}</p></div><p style={{fontSize:"10px",color:"rgba(255,255,255,0.5)",marginTop:"16px",textAlign:"center"}}>GebAG Â§34, Â§35, Â§36</p></div></div>)}
      {activeTab==='katalog'&&(<div style={{background:"#fff",borderRadius:"12px",padding:"24px",boxShadow:"0 2px 8px rgba(0,0,0,0.08)"}}><h3 style={{margin:"0 0 20px",fontSize:"18px"}}>ğŸ“– Fehlerkatalog ISO 6520-1</h3><div className="grid-3">{Object.entries(FEHLERKATALOG).map(([code,f])=>(<div key={code} style={{padding:"16px",borderRadius:"8px",background:f.kritisch?"#fef2f2":"#f8fafc",border:"1px solid "+(f.kritisch?"#fecaca":"#e2e8f0")}}><div style={{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:"8px"}}><span style={{fontWeight:700,fontSize:"18px",color:"#1f2937"}}>{code}</span>{f.kritisch&&(<span style={{background:"#ef4444",color:"#fff",padding:"2px 8px",borderRadius:"4px",fontSize:"10px"}}>KRITISCH</span>)}</div><p style={{fontWeight:600,fontSize:"14px",margin:0,color:"#374151"}}>{f.name}</p></div>))}</div><div style={{marginTop:"24px",padding:"16px",background:"#eff6ff",borderRadius:"8px",border:"1px solid #bfdbfe"}}><h4 style={{margin:"0 0 8px",fontSize:"14px",color:"#1e40af"}}>ğŸ“‹ Referenznormen</h4><div style={{display:"flex",flexWrap:"wrap",gap:"8px",fontSize:"12px"}}>{["ISO 6520-1","ISO 5817","ISO 17637","ISO 15614-1"].map((n,i)=>(<span key={i} style={{background:"#fff",padding:"4px 8px",borderRadius:"4px",border:"1px solid #bfdbfe"}}>{n}</span>))}</div></div></div>)}
    </main>
    <footer style={{padding:"20px 32px",background:"#1f2937",marginTop:"40px",borderTop:"4px solid #f97316"}}><div style={{display:"flex",justifyContent:"space-between",alignItems:"center",maxWidth:"1400px",margin:"0 auto"}}><p style={{fontSize:"11px",color:"rgba(255,255,255,0.5)",margin:0}}>SV Gutachten v10.0 TÃœV-Edition | Claude Vision | ISO 15614-1, ISO 5817 | 2025</p><span style={{background:apiStatus.anthropic?"rgba(34,197,94,0.2)":"rgba(239,68,68,0.2)",padding:"4px 8px",borderRadius:"4px",fontSize:"10px",color:apiStatus.anthropic?"#4ade80":"#f87171"}}>Claude Vision: {apiStatus.anthropic?"âœ“":"âœ—"}</span></div></footer>
  </div>);
}
const root=ReactDOM.createRoot(document.getElementById('root'));
root.render(<SchweissGutachterApp/>);
</script>
</body>
</html>
